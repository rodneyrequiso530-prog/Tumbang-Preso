<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Running Man with Chasing Enemies</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: linear-gradient(to top, #2e8b57, #87CEEB);
        }

        #gameArea {
            position: relative;
            width: 100vw;
            height: 100vh;
            perspective: 1000px; /* Add perspective for 3D effect */
            overflow: hidden;
        }

        #man {
            position: absolute;
            bottom: 50px;
            left: 50px;
            width: 60px;
            height: 80px;
            background: linear-gradient(to bottom, #ff7e5f, #feb47b); /* A simple gradient for the man */
            border-radius: 10px;
            transform-origin: bottom center;
            transition: transform 0.3s ease-in-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .obstacle {
            position: absolute;
            bottom: 50px;
            width: 30px;
            height: 60px;
            background: #ff6347;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transform-origin: bottom center;
        }

        .enemy {
            position: absolute;
            bottom: 50px;
            width: 60px;
            height: 80px;
            background: linear-gradient(to bottom, #ff4500, #f08080); /* Red for enemies */
            border-radius: 10px;
            transform-origin: bottom center;
            transition: transform 0.3s ease-in-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        #score {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 30px;
            font-family: 'Arial', sans-serif;
            color: #fff;
        }

        .ground {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 50px;
            background: linear-gradient(to bottom, #444, #333);
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.5);
        }
    </style>
</head>
<body>

<div id="gameArea">
    <div id="man"></div>
    <div id="score">Score: 0</div>
    <div class="ground"></div>
</div>

<script>
    let gameArea = document.getElementById('gameArea');
    let man = document.getElementById('man');
    let scoreDisplay = document.getElementById('score');
    let gameWidth = window.innerWidth;
    let gameHeight = window.innerHeight;
    let gravity = 2;
    let jumpPower = 18;
    let isJumping = false;
    let score = 0;

    // Variables for enemies
    let enemies = [];
    let enemySpeed = 3;

    // Create enemies
    function createEnemy() {
        // Enemy 1 (Left Side)
        let enemy1 = document.createElement('div');
        enemy1.classList.add('enemy');
        enemy1.style.left = '50px';
        enemy1.style.bottom = '50px';
        gameArea.appendChild(enemy1);

        // Enemy 2 (Right Side)
        let enemy2 = document.createElement('div');
        enemy2.classList.add('enemy');
        enemy2.style.left = gameWidth - 110 + 'px'; // Right side
        enemy2.style.bottom = '50px';
        gameArea.appendChild(enemy2);

        enemies.push(enemy1, enemy2);
    }

    // Move enemies towards the player
    function moveEnemies() {
        enemies.forEach(enemy => {
            let enemyLeft = parseInt(enemy.style.left);
            let playerLeft = parseInt(man.style.left);
            let direction = playerLeft > enemyLeft ? 1 : -1;  // Move towards player

            // Move enemy in the X direction towards the player
            enemy.style.left = (enemyLeft + (direction * enemySpeed)) + 'px';

            // Check for collision with player
            if (Math.abs(enemyLeft - playerLeft) < 60 && Math.abs(parseInt(enemy.style.bottom) - parseInt(man.style.bottom)) < 80) {
                alert('Game Over! Final Score: ' + score);
                location.reload(); // Reload the game on game over
            }
        });
    }

    // Handle jumping with 3D effect
    function jump() {
        if (!isJumping) {
            isJumping = true;
            let jumpHeight = 0;

            let jumpInterval = setInterval(() => {
                if (jumpHeight < jumpPower) {
                    man.style.transform = `translateY(-${jumpHeight}px) rotateX(-30deg)`;
                    jumpHeight += 10;
                } else {
                    clearInterval(jumpInterval);
                    let fallInterval = setInterval(() => {
                        if (parseInt(man.style.bottom) > 50) {
                            man.style.transform = `translateY(${gravity}px) rotateX(0deg)`;
                        } else {
                            clearInterval(fallInterval);
                            man.style.transform = `translateY(0)`;
                            isJumping = false;
                        }
                    }, 20);
                }
            }, 20);
        }
    }

    // Create 3D obstacles
    function createObstacle() {
        let obstacle = document.createElement('div');
        obstacle.classList.add('obstacle');
        obstacle.style.left = gameWidth + 'px';
        gameArea.appendChild(obstacle);

        let moveObstacle = setInterval(() => {
            let obstacleLeft = parseInt(obstacle.style.left);

            if (obstacleLeft < -30) {
                clearInterval(moveObstacle);
                gameArea.removeChild(obstacle);
                score++;
                scoreDisplay.textContent = 'Score: ' + score;
            } else {
                obstacle.style.left = obstacleLeft - 5 + 'px';

                // Add 3D movement (perspective)
                obstacle.style.transform = `rotateY(${obstacleLeft / 100}deg)`;

                // Check for collision
                if (obstacleLeft < 100 && obstacleLeft > 50 && parseInt(man.style.bottom) <= 50) {
                    alert('Game Over! Final Score: ' + score);
                    location.reload(); // Reload the game on game over
                }
            }
        }, 20);
    }

    // Generate obstacles at intervals
    setInterval(createObstacle, 2000);

    // Listen for jump event
    window.addEventListener('keydown', (e) => {
        if (e.key === ' ' || e.key === 'ArrowUp') {
            jump();
        }
    });

    // Start the game by creating enemies
    createEnemy();

    // Game loop to move enemies and update score
    function gameLoop() {
        moveEnemies();
        requestAnimationFrame(gameLoop);
    }

    gameLoop(); // Start the game loop
</script>

</body>
</html>
